/* simplified for brevity but same as previous */